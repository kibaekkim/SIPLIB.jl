%\begin{itemize}
%  \item Coin-SMI (\url{https://github.com/coin-or/Smi}): compile with CPLEX; can read SMPS and solve in extensive form.
%  \item DSP: Benders/dual decomposition
%  \item PySP: Progressive Hedging
%\end{itemize}
%
%- problem characteristics
%
%- preliminary results using CPLEX

%\kk{Please describe what you present in this section. Subsectioning would also help.} \yoc{This section is newely written. Need more justification.} 
\siplibtwo\ provides \smps\ instances for test and benchmarking  purpose. In this section, we report detailed information on each instance. This includes numerical size information, sparsity information, and computational results.
%\begin{itemize}
%	\item Commercial MIP solver (CPLEX) result: optimality gap, integrality gap (LP relaxation gap, tightness), solution time, obj value
%	\item DD solver (DSP) result: optimality gap, duality gap (convex relaxation gap), solution time, obj value
%\end{itemize}

\subsection{Size and sparsity information}
Table \ref{table:instance_size_info_dcap}-\ref{table:instance_size_info_suc} in Section \ref{sec:instance_size_sparsity} report numerical size and sparsity information for each instance. The information is reported both blockwisely and totally. For example, the second-stage size information reports the number of variables in a single-scenario block (block W in Fig. \ref{fig:stagewise_sparsity}). Sparsity is reported in percentage (\%) and the file size is reported in kilobytes (KB).

\subsection{Computational results}
We report computational information resulted from experiments. Unlike the size information, this information should be obtained highly computational methods. The result is provided in Table \ref{table:computation_report}. Throughout the following subsections, we explain about the computational experiments.

\subsubsection{Experimental setting}
%Table \ref{table:experimental_setting} summarizes the experimental setting. 
All the experiments were run on \textit{Bebop}, a 1024-node computing cluster at Argonne National Laboratory \cite{bebop}. Each node in Bebop has 128GB DDR4 memory, 45MB smart cache, and Intel Xeon Processor E5-2695 v4 that consists of 18 physical cores and 36 logical threads with base processor frequency 2.10GHz and maximum turbo frequency 3.30GHz. 

We use two solvers, a commercial branch-and-cut based MIP solver \cplex\ 12.8 and an open-source DD based SIP solver \dsp. Since \cplex\ does not support \smps\ format as input, we use \dsp's option to solve the EF reading \smps\ files. For solving master/sub problems during DD procedure in \dsp, we also use \cplex\ 12.8. We fully utilize 36 threads for each single instance as the both two solvers support multi-threads parallel computing. We set the termination condition on CPU time by 3 hours.  

The size of the instances on which the experiments perform is chosen basically based on the former \siplib. Additionally, we generate and include some large-scenario instances into the experiments.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
%\begin{table}[H]
%	\centering
%	\caption{Experimental setting}
%	\label{table:experimental_setting}
%	\resizebox{\textwidth}{!}{%
%	\begin{tabular}{|l|l|}
%		\hline
%		\multirow{4}{*}{Computing environment} & Bebop (ANL 1024-node computing cluster) with each node      \\
%		& - CPU: Intel Xeon Processor E5-2695 v4 (18 cores 36 threads) \\
%		& - Clock speed: 2.10GHz (maximum 3.30GHz)                     \\
%		& - Memory:128GB (45MB Smart cache)                            \\ \hline
%		\multirow{2}{*}{Solver}                & Commercial MIP solver: CPLEX 12.8                                \\
%		& Open-source SIP solver: DSP                                      \\ \hline
%		Threads per instance                 & 36                                                           \\ \hline
%		Time limit                             & 3 hours                                                      \\ \hline
%		Instance size                          & SIPLIB instance sizes + Large scenario instance                  \\ \hline
%	\end{tabular}
%	}
%\end{table}

\subsubsection{Solution report}
We first introduce the notations used to define each column in the report Table \ref{table:computation_report}. The summary for the notations can be found in Table \ref{table:objective-notation}.

First, recall the extensive form RP in Section \ref{sec:sip}:
\begin{subequations}\label{ef}
	\begin{align}
	\textrm{(RP-EF) }\min_{x,\mathrm{y}}\ z(x,\mathrm{y}):=&\ c^{\top}x + \sum_{s=1}^{r}\PP(s) (q_s^{\top}y_s) \tag{\ref{ef:obj}}\\ 
	\mathrm{s.t.}\ &Ax\ge b,  \tag{\ref{ef:b}}\\
	&T_s x+W_s y_s\ge h_s,\quad\forall s\in\{1,\ldots,r\}, \tag{\ref{ef:c}} \\
	&x\in X, \tag{\ref{ef:d}} \\
	&y_s \in Y,\quad\forall s\in\{1,\ldots,r\}. \tag{\ref{ef:e}}
	\end{align}
\end{subequations}

We use the vanilla $z$ to denote the value of the objective function in RHS of (\ref{ef:obj}) such that constraints (\ref{ef:b})-(\ref{ef:e}) are satisfied throughout this section and the report. We use the superscripted notation $z^*$ to denote the optimal objective value, $\tilde{z}$ for the best lower bound discovered for $z^*$, and $\hat{z}$ for the incumbent (best known integer solution) objective value. Hence, the relationship $\tilde{z}\le z^*\le\hat{z}$ always holds.

$z_{LP2}$ is defined by the objective value of the following partly LP-relaxed problem:
\begin{subequations}\label{ef-lp2}
	\begin{align}
	\textrm{(RP-LP2) }\min_{x,\mathrm{y}}\ z_{LP2}(x,\mathrm{y}):=&\ c^{\top}x + \sum_{s=1}^{r}\PP(s) (q_s^{\top}y_s) \tag{\ref{ef:obj}}\\ 
	\mathrm{s.t.}\ &\textrm{(\ref{ef:b})-(\ref{ef:d})}, \nonumber \\
	& y_s \in Y \subseteq \mathbb{R}\backslash\mathbb{Z} ,\quad\forall s\in\{1,\ldots,r\}. \tag{\ref{ef:e}'}
	\end{align}
\end{subequations}
Note that only the integrality of the second-stage variables is relaxed.

$z_{LD}$ is defined by the objective value of the corresponding Lagrangian dual problem. The Lagrangian dual problem can be derived from RP-EF' (\ref{sip:ef'}) by introducing the nonanticipativity constraints (\ref{eq:SIP_2-2}) into the objective function (\ref{eq:SIP_2-1}):
\begin{subequations}\label{ld}
	\begin{align}
	\textrm{(RP-LD) }\max_{\Lambda}\ z_{LD}(\Lambda) :=\min_{\mathrm{x},\mathrm{y}}  &\sum_{s=1}^{r}\left[\PP(s)\left(c^{\top}x_s+q_s^{\top}y_s\right)+\lambda_s^\top \left(H_s x_s\right)\right] \label{ld:obj}\\ 
	\mathrm{s.t.}\ & (x_s,y_s)\in G_s,\quad \forall s\in\{1,\ldots,r\},	 \label{ld:b}\\
	&\lambda_s\in\mathbb{R}^{r\cdot n_1},\quad \forall s\in\{1,\ldots,r\}, \label{ld:c}
	\end{align}
\end{subequations}
where $\Lambda:=\{\lambda_1,\ldots,\lambda_r\}$ and the scenario feasibility set $G_s$ is still defined by (\ref{eq:SIP_2-4}).

$z_{EV}$ is the objective value of the \textit{expected value problem}, which simply considers only the expected scenario data, $\bar{q}$, $\bar{h}$, $\bar{T}$, $\bar{W}$:
\begin{subequations}\label{ev}
	\begin{align}
	\min_{x,y}\ z_{EV}(x,y):=&\ c^{\top}x + \bar{q}^{\top}y \label{ev:obj}\\ 
	\mathrm{s.t.}\ &Ax\ge b,  \label{ev:b}\\
	&\bar{T} x+\bar{W} y\ge \bar{h},  \label{ev:c}\\
	&x\in X,  \label{ev:d}\\
	&y \in Y. \label{ev:e}
	\end{align}
\end{subequations}

$z_{EEV}$ is defined by the \textit{expected result of using the first-stage solution of EV}, say $\bar{x}$: 
\begin{subequations}\label{eev}
	\begin{align}
	\min_{\mathrm{y}}\ z_{EEV}(\mathrm{y}):=&\ c^{\top}\bar{x} + \sum_{s=1}^{r}\PP(s) (q_s^{\top}y_s) \label{eev:obj}\\ 
	\mathrm{s.t.}\ &W_s y_s\ge h_s-T_s \bar{x},\quad\forall s\in\{1,\ldots,r\}, \label{eev:b}\\
	&y_s \in Y,\quad\forall s\in\{1,\ldots,r\}. \label{eev:c}
	\end{align}
\end{subequations}

$z_{WS}$ is called the \textit{wait-and-see solution value} defined by
\begin{align} \label{ws}
	z_{WS}:=\sum_{s=1}^r \PP(s)z^*(x,y_s),
\end{align}
where $z^*(x,y_s)$ is the optimal objective value of a single scenario problem: 
\begin{subequations}
	\begin{align}
	\min_{x,y_s}\ z(x,y_s):=&\ c^\top x+q_s^\top y_s \label{ssp:obj}\\
	\mathrm{s.t.}\ &Ax \ge b \label{ssp:b}\\
	&T_s x + W_s y_s\ge h_s,  \label{ssp:c}\\
	&x\in X,  \label{ssp:d}\\
	&y_s \in Y. \label{ssp:e}
	\end{align}
\end{subequations}
Noticeably, the inequality $z^*_{WS}\le z^*\le z^*_{EEV}$ is known to always hold.

\begin{table}[H]
	\centering
	\caption{Solution notation}
	\label{table:objective-notation}
	\resizebox{\textwidth}{!}{%
	\begin{threeparttable}
%		\begin{tabular}{@{}ll@{}}
		\begin{tabular}{@{}ll@{}}
			\toprule
			Notation  & \multicolumn{1}{c}{Meaning}                                                                                                                    \\ \midrule
			$z$       & Objective value of RP (\ref{ef:obj})-(\ref{ef:e})                                                                                         \\
			$z_{LP2}$ & Objective value of RP with the second-stage only LP-relaxation (\ref{ef:obj})-(\ref{ef:d}),(\ref{ef:e}')                                              \\
			$z_{LD}$  & Objective value of the Lagrangian dual problem of RP (\ref{ld:obj})-(\ref{ld:c}) \\ 
			$z_{EV}$ & Objective value of the expected value problem (\ref{ev:obj})-(\ref{ev:d})\\
			$z_{EEV}$ & Objective value of RP using the first-stage solution obtained from EV (\ref{eev:obj})-(\ref{eev:c})\\
			$z_{WS}$ & Expectation of the objective value of single scenario problem (\ref{ws}),(\ref{ssp:obj})-(\ref{ssp:e})\\
			\bottomrule
		\end{tabular}%
				
		\begin{tablenotes}
			\small
			\item $z^*$: optimal objective value
			\item $\tilde{z}$: best discovered lower bound for $z^*$ 
			\item $\hat{z}$: incumbent objective value (best upper bound)
		\end{tablenotes}
	\end{threeparttable}
	}
\end{table}
%\subsubsection {Basic results from the two solvers: \cplex\ and \dsp}
In Table \ref{table:computation_report}, we report objective values and several gaps obtained from the two solvers. Each gap is useful to compare the characteristics of instances with each other. There is no guarantee that we can always obtain the optimal solution for each instance, we report the best results discovered within the limited processing time (3 hours). Table \ref{table:gap} summarizes the definition of each gap using the notation defined in Table \ref{table:objective-notation}.
%\begin{table}[H]
%	\centering
%	\caption{Gap definition}
%	\label{table:gap}
%	\begin{tabular}{@{}lcc@{}}
%		\toprule
%		Gap                  & Absolute value definition  & Reported value  \\ \midrule
%		ROG  & $N/A$ & $\frac{|\hat{z}-\tilde{z}|}{|\hat{z}|+\epsilon}\times 100\%$   \\
%		RIG &  $z^*-z^*_{LP2}$          &        $\frac{\hat{z}}{\hat{z}_{LP2}}$       \\
%		RDG     &      $z^*-z^*_{LD}$     &        $\frac{|\hat{z}-\hat{z}_{LD}|}{|\hat{z}|+\epsilon}\times 100\%$        \\
%		REVPI                 &      $z^*-z^*_{WS}$      &       $\frac{|\hat{z}-\hat{z}_{WS}|}{|\hat{z}|+\epsilon}\times 100\%$         \\ 
%		RVSS	& $z^*_{EEV}-z^*$	&	\\\bottomrule
%	\end{tabular}
%\end{table}


\begin{table}[H]
	\centering
	\caption{Gap definition}
	\label{table:gap}
	\begin{tabular}{lcc}
		\hline
		Gap   & Target to compare ($x$) & Reported value                                                        \\ \hline
		Optimality gap (OG)   & $\tilde{z}$        & \multirow{5}{*}{$\frac{|\hat{z}-x|}{|\hat{z}|+\epsilon}\times 100\%$} \\
		Integrality gap (IG)   & $\hat{z}_{LP2}$    &                                                                       \\
		Duality gap (DG)   & $\hat{z}_{LD}$     &                                                                       \\
		Relative EVPI (REVPI) & $\hat{z}_{WS}$     &                                                                       \\
		Relative VSS (RVSS)  & $\hat{z}_{EEV}$    &                                                                       \\ \hline
	\end{tabular}
\end{table}

\begin{quote}
	\noindent\textit{Objective value with processing time} We report the objective values from the two solvers. This value is $z^*$ if the optimality is attained in the time limit, but $\hat{z}$ otherwise.
\end{quote}

\begin{quote}
	\noindent\textit{Optimality Gap (OG)} This gap is only computational concept defined by the relative difference between best upper bound and best lower bound. We report the relative value $\frac{|\hat{z}-\tilde{z}|}{|\hat{z}|+\epsilon}\times 100\%$ obtained from the two solvers. This can be a basic measure of difficulty of an instance combined with processing time.
\end{quote}

%\begin{quote}
%\noindent\underline{\textit{Optimality gap (OG)}} This gap, defined by, $\frac{|\underline{\hat{z}}-\hat{z}|}{|\hat{z}|+\epsilon}$, is reported from the two solvers. $\underline{\hat{z}}$ means the best lower bound discovered and $\hat{z}$ is the incumbent objective. The gap is obtained by keeping track of the best relaxation currently in the pool of nodes waiting for further processing. This can be a basic measure of difficulty of an instance combined with processing time.
%\end{quote}

\begin{quote}
	\noindent\textit{Integrality Gap (IG)} We define this gap by the difference in optimal objective values between RP and RP-LP2: $z^*-z^*_{LP2}$. We report relative incumbent value: $\frac{|\hat{z}-\hat{z}_{LP2}|}{|\hat{\hat{z}}|+\epsilon}\times 100\%$ It is reported by the open-source DD solver \dsp. 
	
%	We define a SIP-specific theoritic integrality gap in minimization problem by $\frac{z^*}{z^*_{LP2}}$. Computationally, we report $\frac{\hat{z}}{\hat{z}_{LP2}}$ when the optimality is not attained. Assuming $\hat{z}_{LP2}\approxeq z^*_{LP2}$ in most cases, the reported IG will provide upper bound for the true IG. The LP-relaxation provides an optimistic bound on the integer program's solution. The small this gap implies that the LP-relaxation gives tight bound for the original problem.  %This gap cannot be obtained analytically so we report it based on the computational experiments.% The formulation with tighter LP relaxation is always favorable.
\end{quote}

%\begin{quote}
%\noindent\underline{\textit{Integrality gap (IG)}} We define a SIP-specific integrality gap (IG) in minimization problem by $\frac{z^*}{z^*_{LP2}}$, where $z^*$ is the optimal integral solution and $z^*_{LR2}$ is the optimal fractional solution with LP-relaxed second-stage. This LP relaxation provides an optimistic bound on the integer program's solution. The small this gap implies tightness of the LP relaxation. Since there is no guarantee that we always find the optimal solutions, we report $\frac{\hat{z}}{\hat{z}_{LP2}}$ where $\hat{z}$ and $\hat{z}_{LP2}$ are the incumbent solutions. Assuming $\hat{z}_{LP2}\approxeq z^*_{LP2}$ in most cases, the reported IG will provide upper bound for the true IG. The tightness of this bound highly depends on the quality of the incumbent solution $\hat{z}$.%This gap cannot be obtained analytically so we report it based on the computational experiments.% The formulation with tighter LP relaxation is always favorable.
%\end{quote}
%
%\begin{quote}
%	\noindent\underline{\textit{Duality gap (DG)}} The duality gap in computational optimization is the difference between any dual objective and the incumbent primal objective. This gap also equals to the value of the convex relaxation of the primal problem. It is reported by the open-source DD solver \dsp.
%\end{quote}

\begin{quote}
\noindent\textit{Duality Gap (DG)} This gap is the difference between primal objective and dual objective: $z^*-z^*_{LD}$. This gap also equals to the value of the convex relaxation of the primal problem. We report relative value: $\frac{|\hat{z}-\hat{z}_{LD}|}{|\hat{\hat{z}}|+\epsilon}\times 100\%$. It is reported by the open-source DD solver \dsp. 
\end{quote}

\begin{quote}
\noindent\textit{Relative EVPI (REVPI)} This gap is the relative version of the \textit{expected value of perfect information} (EVPI) which is defined by $z^*-z^*_{WS}$ theoritically. This measures the maximum amount a decision maker would be ready to pay in return for complete (and accurate) information about the future. We report $\frac{|\hat{z}-\hat{z}_{WS}|}{|\hat{\hat{z}}|+\epsilon}\times 100\%$ using \cplex.
\end{quote}

\begin{quote}
	\noindent\textit{Relative VSS (RVSS)} This gap is the relative version of the \textit{value of the stochastic solution} (VSS) which is defined by $z^*_{EEV}-z^*$. This allows us to obtain the goodness of the expected solution value when the expected values are replaced by the random values for the input variables. We report $\frac{|\hat{z}-\hat{z}_{EEV}|}{|\hat{\hat{z}}|+\epsilon}\times 100\%$ using \cplex.
\end{quote}

\input{./tables/table_instance_solution_report}

%\begin{quote}
%\noindent\underline{\textit{Symmetry gap (SG)}} An MIP is \textit{symmetric} if its variables can be permuted without changing the structure of the problem. The symmetry is one of the frequently mentioned factors that affects the difficulty of optimization problem. Unfortunately, no universally applicable quantification for the impact of symmetry is available. Hence, we heuristically define the symmetry gap using \cplex\ option (Table \ref{table:cplex_symmetry}). That is,  
%\end{quote}

%\begin{quote}
%	\centering$\frac{|\textrm{\cplex\ solution}-\textrm{\cplex\ solution with the strongest symmetry breaking}|}{|\textrm{\cplex\ solution}|}$
%\end{quote}

%\begin{table}[H]
%	\centering
%	\resizebox{\textwidth}{!}{%
%		\begin{threeparttable}
%			\caption{Symmetry breaking option of CPLEX }
%			\label{table:cplex_symmetry}
%			\begin{tabular}{@{}cl@{}}
%				\toprule
%				Parameter value & \multicolumn{1}{c}{Meaning}                              \\ \midrule
%				-1    & Automatic: let CPLEX choose; default                     \\
%				0     & Turn off symmetry breaking                               \\
%				1     & Exert a moderate level of symmetry breaking              \\
%				2     & Exert an aggressive level of symmetry breaking           \\
%				3     & Exert a very aggressive level of symmetry breaking       \\
%				4     & Exert a highly aggressive level of symmetry breaking     \\
%				5     & Exert an extremely aggressive level of symmetry breaking \\ \bottomrule
%			\end{tabular}
%			\begin{tablenotes}
%				\small
%				\item *Parameter in \texttt{C} API is 	$\texttt{CPXPARAM\_Preprocessing\_Symmetry}$ for $>$12.6.0 and $\texttt{CPX\_PARAM\_SYMMETRY}$ for $\le$12.6.0
%			\end{tablenotes}
%		\end{threeparttable}
%	}
%\end{table}